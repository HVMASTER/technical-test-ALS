<div *ngIf="informes" class="list-container">
  <div *ngIf="!selectedInforme" class="informes-list">
    <ul>
      <li *ngFor="let informe of informes" (click)="selectInforme(informe)">
        {{ informe.numeroInforme }}
      </li>
    </ul>
  </div>
</div>

<button (click)="deselectInforme()" class="back-button">Volver</button>
<button (click)="togglePreview()">Vista Previa</button>
<button (click)="generatePDF()">Exportar a PDF</button>
<div *ngIf="isLoading" class="loading-bar">
  <div class="spinner"></div>
</div>

<div *ngIf="isSaving" class="loading-bar">
  <div class="spinner"></div>
  <p>{{ savingMessage }}</p>
</div>

<div *ngIf="!isLoading">
  <div *ngIf="selectedInforme" class="form-container">
    <div *ngIf="isLoadingPdf" class="loading-bar">
      <p>Generando PDF, por favor espere...</p>
      <div class="spinner"></div>
    </div>

    <app-info-message
      [message]="messageText"
      [type]="messageType"
      [show]="showMessage"
      [duration]="5000"
      (accept)="onAccept()"
      (cancel)="onCancel()"
    >
    </app-info-message>

    <app-report-modal-component
      *ngIf="showModal && modalInstance"
      [idInforme]="modalInstance?.idInforme"
      [idDetalle]="modalInstance?.idDetalle"
      [idStatus]="modalInstance?.idStatus"
      [numeroInforme]="modalInstance?.numeroInforme"
      [allowImages]="modalInstance?.allowImages"
      [uploadImageService]="modalInstance?.uploadImageService"
      (save)="closeModal($event)"
      (cancel)="cancelModal()"
    >
    </app-report-modal-component>

    <div id="contentToConvert">
      <div *ngIf="showHeaderFooter" class="header">
        <app-header></app-header>
      </div>

      <div class="title-main">
        <h1>
          INFORME DE INSPECCIÓN Y PRUEBA DE CARGA A GRÚAS FIJAS y MÓVILES EN
          PUERTO
        </h1>
      </div>

      <div class="page">
        <div class="content">
          <form [formGroup]="informeForm" class="A-C">
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <button
                (click)="toggleEdit()"
                [disabled]="isAnyEditing && !isEditing"
              >
                {{ isEditing ? "Cancelar" : "Editar" }}
              </button>
              <button *ngIf="isEditing" (click)="saveChanges()">Guardar</button>
            </div>

            <div class="form-row">
              <div class="title">
                <label>Informe N°</label>
              </div>
              <label>{{ informeForm.get("numeroInforme")?.value }}</label>
              <label>Certificado asociado N°</label>
              <ng-container *ngIf="isEditing; else viewCertificado">
                <input formControlName="numeroInforme" type="text" />
              </ng-container>
              <ng-template #viewCertificado>
                <label>{{ informeForm.get("numeroInforme")?.value }}</label>
              </ng-template>
            </div>
            <div class="form-row">
              <div class="title">
                <label>Solicitado por</label>
              </div>
              <label>Empresa</label>
              <ng-container *ngIf="isEditing; else viewEmpresa">
                <input formControlName="empresa" type="text" />
              </ng-container>
              <ng-template #viewEmpresa>
                <label>{{ informeForm.get("empresa")?.value }}</label>
              </ng-template>
              <label>Persona</label>
              <ng-container *ngIf="isEditing; else viewPersona">
                <input formControlName="persona" type="text" />
              </ng-container>
              <ng-template #viewPersona>
                <label>{{ informeForm.get("persona")?.value }}</label>
              </ng-template>
            </div>
            <div class="form-row">
              <div class="title">
                <label>Equipo</label>
              </div>
              <ng-container *ngIf="isEditing; else viewEquipo">
                <input formControlName="equipo" type="text" />
              </ng-container>
              <ng-template #viewEquipo>
                <label>{{ informeForm.get("equipo")?.value }}</label>
              </ng-template>
            </div>
            <div class="form-row">
              <div class="title">
                <label>Marca</label>
              </div>
              <ng-container *ngIf="isEditing; else viewMarca">
                <input formControlName="marca" type="text" />
              </ng-container>
              <ng-template #viewMarca>
                <label>{{ informeForm.get("marca")?.value }}</label>
              </ng-template>
            </div>

            <div class="form-row">
              <div class="form-row-custom">
                <div class="column-title-main text-right">
                  <label>Carga segura de trabajo (SWL)</label>
                </div>
                <div class="column-data">
                  <ng-container *ngIf="isEditing; else viewCargaSegura">
                    <input formControlName="cargaSegura" type="text" />
                  </ng-container>
                  <ng-template #viewCargaSegura>
                    <label
                      >{{
                        informeForm.get("cargaSegura")?.value || "N/A"
                      }}
                      ton</label
                    >
                  </ng-template>

                  <ng-container *ngIf="isEditing; else viewCargaSeguraDos">
                    <input formControlName="cargaSeguraDo" type="text" />
                  </ng-container>
                  <ng-template #viewCargaSeguraDos>
                    <label
                      >{{
                        informeForm.get("cargaSeguraDo")?.value || "N/A"
                      }}
                      ton</label
                    >
                  </ng-template>
                </div>

                <div class="column-title">
                  <label>Ángulo</label>
                </div>
                <div class="column-data">
                  <ng-container *ngIf="isEditing; else viewAngulo">
                    <input formControlName="angulo" type="text" />
                  </ng-container>
                  <ng-template #viewAngulo>
                    <label
                      >{{ informeForm.get("angulo")?.value || "N/A" }}°</label
                    >
                  </ng-template>

                  <ng-container *ngIf="isEditing; else viewAnguloDos">
                    <input formControlName="anguloDos" type="text" />
                  </ng-container>
                  <ng-template #viewAnguloDos>
                    <label
                      >{{
                        informeForm.get("anguloDos")?.value || "N/A"
                      }}°</label
                    >
                  </ng-template>
                </div>

                <div class="column-title">
                  <label>Radio</label>
                </div>
                <div class="column-data">
                  <ng-container *ngIf="isEditing; else viewRadio">
                    <input formControlName="radio" type="text" />
                  </ng-container>
                  <ng-template #viewRadio>
                    <label
                      >{{ informeForm.get("radio")?.value || "N/A" }} m</label
                    >
                  </ng-template>

                  <ng-container *ngIf="isEditing; else viewRadioDos">
                    <input formControlName="radioDos" type="text" />
                  </ng-container>
                  <ng-template #viewRadioDos>
                    <label
                      >{{
                        informeForm.get("radioDos")?.value || "N/A"
                      }}
                      m</label
                    >
                  </ng-template>
                </div>
              </div>
            </div>
            <div class="form-row">
              <div class="title">
                <label>TAG / ID #</label>
              </div>
              <ng-container *ngIf="isEditing; else viewTag">
                <input formControlName="tag" type="text" />
              </ng-container>
              <ng-template #viewTag>
                <label>{{ informeForm.get("Tag")?.value }}</label>
              </ng-template>
            </div>
            <div class="form-row">
              <div class="title">
                <label>Lugar de inspección y prueba</label>
              </div>
              <ng-container *ngIf="isEditing; else viewLugarInspeccion">
                <input formControlName="lugarInspeccion" type="text" />
              </ng-container>
              <ng-template #viewLugarInspeccion>
                <label>{{ informeForm.get("lugarInspeccion")?.value }}</label>
              </ng-template>
            </div>
            <div class="form-row">
              <div class="title">
                <label>Fecha de inspección y prueba</label>
              </div>
              <ng-container *ngIf="isEditing; else viewFechaInspeccion">
                <input formControlName="fechaInspeccion" type="date" />
              </ng-container>
              <ng-template #viewFechaInspeccion>
                <label>{{ informeForm.get("fechaInspeccion")?.value }}</label>
              </ng-template>
            </div>
            <div class="form-row">
              <div class="title">
                <label>Fecha de emisión informe</label>
              </div>
              <label>{{ fechaEmisionInforme }}</label>
            </div>
            <div class="subtitle">
              <h3 class="custom-h3">
                <strong>(CU)</strong> CUMPLE <strong>(N/C)</strong> NO CUMPLE NO
                APLICA
                <strong>(N/A)</strong>
                RECOMENDACIÓN
                <strong>(RE)</strong>
              </h3>
            </div>

            <h2 class="subtitle" *ngIf="tituloForm.length > 0">
              {{ tituloForm[0]?.nombre }}
            </h2>
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <button
                type="button"
                (click)="toggleEditStatusA()"
                [disabled]="isAnyEditing && !isEditingStatusA"
              >
                {{ isEditingStatusA ? "Cancelar" : "Editar" }}
              </button>
              <button
                type="button"
                *ngIf="isEditingStatusA"
                (click)="saveChangesStatusA()"
              >
                Guardar
              </button>
            </div>
            <div class="form-row-A-F">
              <strong class="center">Item</strong>
              <strong class="center">Detalle</strong>
              <strong class="center">Status</strong>
              <strong class="center">Item</strong>
              <strong class="center">Detalle</strong>
              <strong class="center">Status</strong>
            </div>

            <div
              *ngFor="
                let item of itemsWithStatus | slice : 0 : 9;
                let i = index
              "
              class="form-row-A-F"
            >
              <!-- Primera columna, numeración del 1 al 9 -->
              <label class="center"
                ><strong>{{ i + 1 }}</strong></label
              >
              <label title="{{ item.detalle }}">{{ item.detalle }}</label>
              <div *ngIf="isEditingStatusA; else viewMode">
                <div class="options-list">
                  <form>
                    <label *ngFor="let option of optionStatus">
                      <input
                        type="radio"
                        name="option_{{ i }}"
                        [value]="option.idStatus"
                        [checked]="option.alias === item.alias"
                        (change)="
                          selectStatus(
                            itemsWithStatus[i],
                            option.idStatus.toString(),
                            i
                          )
                        "
                      />
                      {{ option.alias }}
                    </label>
                  </form>
                </div>
              </div>
              <ng-template #viewMode>
                <label class="center">{{ item.alias }}</label>
              </ng-template>

              <!-- Segunda columna, numeración del 10 al 18 -->
              <ng-container *ngIf="9 + i < itemsWithStatus.length">
                <label class="center"
                  ><strong>{{ 10 + i }}</strong></label
                >
                <label title="{{ itemsWithStatus[9 + i].detalle }}">{{
                  itemsWithStatus[9 + i]?.detalle
                }}</label>
                <div *ngIf="isEditingStatusA; else viewMode2">
                  <div class="options-list">
                    <form>
                      <label *ngFor="let option of optionStatus">
                        <input
                          type="radio"
                          name="option_{{ 9 + i }}"
                          [value]="option.idStatus"
                          [checked]="
                            option.alias === itemsWithStatus[9 + i]?.alias
                          "
                          (change)="
                            selectStatus(
                              itemsWithStatus[9 + i],
                              option.idStatus.toString(),
                              9 + i
                            )
                          "
                        />
                        {{ option.alias }}
                      </label>
                    </form>
                  </div>
                </div>
                <ng-template #viewMode2>
                  <label class="center">{{
                    itemsWithStatus[9 + i]?.alias
                  }}</label>
                </ng-template>
              </ng-container>
            </div>

            <h2 class="subtitle" *ngIf="tituloForm.length > 0">
              {{ tituloForm[1].nombre }}
            </h2>
            <div *ngIf="!isPreviewMode">
              <button (click)="toggleEditStatusB()">
                {{ isEditingStatusB ? "Cancelar" : "Editar" }}
              </button>
              <button *ngIf="isEditingStatusB" (click)="saveChangesStatusB()">
                Guardar
              </button>
            </div>
            <div class="form-row-A-F">
              <strong class="center">Item</strong>
              <strong class="center">Detalle</strong>
              <strong class="center">Status</strong>
              <strong class="center">Item</strong>
              <strong class="center">Detalle</strong>
              <strong class="center">Status</strong>
            </div>
            <div
              *ngFor="
                let item of itemsWithStatus | slice : 18 : 25;
                let i = index
              "
              class="form-row-A-F"
            >
              <!-- Primera columna, numeración del 19 al 25 -->
              <label class="center"
                ><strong>{{ 19 + i }}</strong></label
              >
              <label title="{{ item.detalle }}">{{ item.detalle }}</label>
              <div *ngIf="isEditingStatusB; else viewMode">
                <div class="options-list">
                  <form>
                    <label *ngFor="let option of optionStatus">
                      <input
                        type="radio"
                        name="option_{{ 18 + i }}"
                        [value]="option.idStatus"
                        [checked]="option.alias === item.alias"
                        (change)="
                          selectStatus(
                            itemsWithStatus[18 + i],
                            option.idStatus.toString(),
                            18 + i
                          )
                        "
                      />
                      {{ option.alias }}
                    </label>
                  </form>
                </div>
              </div>
              <ng-template #viewMode>
                <label class="center">{{ item.alias }}</label>
              </ng-template>

              <!-- Segunda columna, numeración del 26 al 31 -->
              <ng-container *ngIf="25 + i < itemsWithStatus.length && i < 6">
                <label class="center"
                  ><strong>{{ 26 + i }}</strong></label
                >
                <label title="{{ itemsWithStatus[25 + i].detalle }}">{{
                  itemsWithStatus[25 + i]?.detalle
                }}</label>
                <div *ngIf="isEditingStatusB; else viewMode2">
                  <div class="options-list">
                    <form>
                      <label *ngFor="let option of optionStatus">
                        <input
                          type="radio"
                          name="option_{{ 25 + i }}"
                          [value]="option.idStatus"
                          [checked]="
                            option.alias === itemsWithStatus[25 + i]?.alias
                          "
                          (change)="
                            selectStatus(
                              itemsWithStatus[25 + i],
                              option.idStatus.toString(),
                              25 + i
                            )
                          "
                        />
                        {{ option.alias }}
                      </label>
                    </form>
                  </div>
                </div>
                <ng-template #viewMode2>
                  <label class="center">{{
                    itemsWithStatus[25 + i]?.alias
                  }}</label>
                </ng-template>
              </ng-container>

              <!-- Espacio vacío para el ítem 32 -->
              <ng-container *ngIf="i === 6">
                <label class="center"><strong>-</strong></label>
                <label></label>
                <label></label>
              </ng-container>
            </div>
          </form>
        </div>
      </div>

      <div class="page">
        <div class="content">
          <form class="C-D">
            <h2 class="subtitle" *ngIf="tituloForm.length > 0">
              {{ tituloForm[2].nombre }}
            </h2>
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <button type="button" (click)="toggleEditStatusC()">
                {{ isEditingStatusC ? "Cancelar" : "Editar" }}
              </button>
              <button
                type="button"
                *ngIf="isEditingStatusC"
                (click)="saveChangesStatusC()"
              >
                Guardar
              </button>
            </div>
            <div class="form-row-A-F">
              <strong class="center">Item</strong>
              <strong class="center">Detalle</strong>
              <strong class="center">Status</strong>
              <strong class="center">Item</strong>
              <strong class="center">Detalle</strong>
              <strong class="center">Status</strong>
            </div>
            <div
              *ngFor="
                let item of itemsWithStatus | slice : 31 : 41;
                let i = index
              "
              class="form-row-A-F"
            >
              <!-- Primera columna, numeración del 32 al 41 -->
              <label class="center"
                ><strong>{{ 32 + i }}</strong></label
              >
              <label title="{{ item.detalle }}">{{ item.detalle }}</label>
              <div *ngIf="isEditingStatusC; else viewModeC">
                <div class="options-list">
                  <label *ngFor="let option of optionStatus">
                    <input
                      type="radio"
                      name="option_{{ 31 + i }}"
                      [value]="option.idStatus"
                      [checked]="option.alias === item.alias"
                      (change)="
                        selectStatus(
                          itemsWithStatus[31 + i],
                          option.idStatus.toString(),
                          31 + i
                        )
                      "
                    />
                    {{ option.alias }}
                  </label>
                </div>
              </div>
              <ng-template #viewModeC>
                <label class="center">{{ item.alias }}</label>
              </ng-template>

              <!-- Segunda columna, numeración del 42 al 51 -->
              <ng-container *ngIf="41 + i < itemsWithStatus.length && i < 10">
                <label class="center"
                  ><strong>{{ 42 + i }}</strong></label
                >
                <label title="{{ itemsWithStatus[41 + i].detalle }}">{{
                  itemsWithStatus[41 + i]?.detalle
                }}</label>
                <div *ngIf="isEditingStatusC; else viewModeC2">
                  <div class="options-list">
                    <label *ngFor="let option of optionStatus">
                      <input
                        type="radio"
                        name="option_{{ 41 + i }}"
                        [value]="option.idStatus"
                        [checked]="
                          option.alias === itemsWithStatus[41 + i]?.alias
                        "
                        (change)="
                          selectStatus(
                            itemsWithStatus[41 + i],
                            option.idStatus.toString(),
                            41 + i
                          )
                        "
                      />
                      {{ option.alias }}
                    </label>
                  </div>
                </div>
                <ng-template #viewModeC2>
                  <label class="center">{{
                    itemsWithStatus[41 + i]?.alias
                  }}</label>
                </ng-template>
              </ng-container>
            </div>

            <h2 class="subtitle" *ngIf="tituloForm.length > 0">
              {{ tituloForm[3].nombre }}
            </h2>
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <button type="button" (click)="toggleEditDescription()">
                {{ isEditingFormD ? "Cancelar" : "Editar" }}
              </button>
              <button
                type="button"
                *ngIf="isEditingFormD"
                (click)="saveChangesDescription()"
              >
                Guardar
              </button>
            </div>
            <form class="padding-none">
              <div class="form-row-G">
                <strong class="center">ÍTEM</strong>
                <strong class="center">COND</strong>
                <strong class="center">DESCRIPCIÓN</strong>
              </div>

              <!-- Mostrar las descripciones -->
              <div [formGroup]="informeForm">
                <div
                  *ngFor="let descripcion of descripcionItems; let i = index"
                  class="form-row-G editInputFormG"
                >
                  <label class="center"
                    ><strong>{{ descripcion.idDetalle }}</strong></label
                  >
                  <label class="center">{{
                    getStatusLabel(descripcion.idStatus)
                  }}</label>

                  <div *ngIf="isEditingFormD; else viewModeFormD">
                    <input
                      [formControlName]="'descripcion_' + i"
                      type="text"
                      class="edit-input"
                    />
                  </div>
                  <ng-template #viewModeFormD>
                    <label>{{ descripcion.descripcion }}</label>
                  </ng-template>
                </div>
              </div>

              <!-- Mostrar filas vacías por defecto -->
              <div
                *ngFor="let i of defaultEmptyRows"
                class="form-row-G editInputFormG"
              >
                <label class="center"><strong>&nbsp;</strong></label>
                <label class="center">&nbsp;</label>
                <label class="center">&nbsp;</label>
              </div>
            </form>
            <h2>Notas en columna descripción:</h2>
            <ul>
              <h2>
                - La palabra <strong>“debe”</strong> indica un requisito.Se
                relaciona con una no conformidad (N/C) y debe ser corregida por
                el cliente.
              </h2>
              <h2>
                - La palabra <strong>“debería”</strong> indica una
                recomendación/observación (RE). Puede o no ser tratada por el
                cliente.
              </h2>
            </ul>
            <h3>
              Nota <span class="underline">muy importante</span>: Si
              correspondiesen acciones correctivas (por no conformidades, n/c),
              estas deberán ser solucionadas o tratadas por el cliente en el
              menor tiempo posible con el fin de reducir los riesgos asociados
              de mantener en operación un equipo sub-estándar.
            </h3>
            <h3 class="custom-h3 font-italic">
              Las observaciones importantes de seguridad (N/C) deberán, si
              corresponde, ser levantadas mediante el documento “levantamiento
              de no conformidades”.
            </h3>
          </form>
        </div>
      </div>

      <div class="page">
        <div class="content">
          <form class="E">
            <h2 class="subtitle" *ngIf="tituloForm.length > 0">
              {{ tituloForm[4].nombre }}
            </h2>
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <button type="button" (click)="toggleEditFormE()">
                {{ isEditingFormE ? "Cancelar" : "Editar" }}
              </button>
              <button
                type="button"
                *ngIf="isEditingFormE"
                (click)="saveFormEChanges()"
              >
                Guardar
              </button>
            </div>
            <form class="padding-none" [formGroup]="formE">
              <div class="form-row-H">
                <label class="paddingLeft"
                  ><strong>Fecha prueba de carga</strong></label
                >
                <ng-container *ngIf="isEditingFormE; else viewModeFecha">
                  <input formControlName="fecha" type="date" />
                </ng-container>
                <ng-template #viewModeFecha>
                  <label>{{ formatDate(formEData?.fecha) }}</label>
                </ng-template>
              </div>
              <!-- Campo Vigencia prueba de carga -->
              <div class="form-row-H">
                <label class="paddingLeft"
                  ><strong>Vigencia prueba de carga</strong>
                </label>
                <ng-container *ngIf="isEditingFormE; else viewModeVigencia">
                  <input formControlName="vigencia" type="date" />
                </ng-container>
                <ng-template #viewModeVigencia>
                  <label>{{ formatDate(formEData?.vigencia) }}</label>
                </ng-template>
              </div>
              <!-- Campo Lugar de prueba de carga -->
              <div class="form-row-H">
                <label class="paddingLeft"
                  ><strong>Lugar de prueba de carga</strong></label
                >
                <ng-container *ngIf="isEditingFormE; else viewModeLugar">
                  <input formControlName="lugar" type="text" />
                </ng-container>
                <ng-template #viewModeLugar>
                  <label>{{ formEData?.lugar }}</label>
                </ng-template>
              </div>
              <div class="form-row-H">
                <label class="paddingLeft"
                  ><strong
                    >Norma para certificación Carga de Prueba</strong
                  ></label
                >
                <!-- Valor fijo -->
                <label
                  >ILO CODE, Seguridad y Salud en los Puertos, Apéndice D.1
                  (grúas) convenio 32 y 152</label
                >
              </div>
              <div class="form-row-H equipo-medicion">
                <div class="titulo-columna">
                  <h4>Equipos / instrumentos de medición</h4>
                </div>
                <div class="equipo-datos">
                  <div class="equipo-header">
                    <label><strong>Nombre de equipo</strong></label>
                    <label><strong>SI</strong></label>
                    <label><strong>NO</strong></label>
                    <label><strong>Certificado Número</strong></label>
                  </div>
                  <div class="equipo-items">
                    <!-- Cinta métrica -->
                    <div class="form-row">
                      <label>Cinta métrica (flexómetro)</label>
                      <ng-container
                        *ngIf="isEditingFormE; else viewModeCintaMetrica"
                      >
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="cintaMetrica"
                            value="SI"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="cintaMetrica"
                            value="NO"
                          />
                        </label>
                        <input
                          formControlName="cintaMetricaNCertificado"
                          type="text"
                        />
                      </ng-container>
                      <ng-template #viewModeCintaMetrica>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.cintaMetrica === "SI" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.cintaMetrica === "NO" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">{{
                          formEData?.cintaMetricaNCertificado !== "N/A"
                            ? formEData?.cintaMetricaNCertificado
                            : "N/A"
                        }}</label>
                      </ng-template>
                    </div>
                    <!-- Pie de metro -->
                    <div class="form-row">
                      <label>Pie de metro (caliper)</label>
                      <ng-container
                        *ngIf="isEditingFormE; else viewModePieMetro"
                      >
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="pie_metro"
                            value="SI"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="pie_metro"
                            value="NO"
                          />
                        </label>
                        <input
                          formControlName="pie_metroNCertificado"
                          type="text"
                        />
                      </ng-container>
                      <ng-template #viewModePieMetro>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.pie_metro === "SI" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.pie_metro === "NO" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">{{
                          formEData?.pie_metroNCertificado !== "N/A"
                            ? formEData?.pie_metroNCertificado
                            : "N/A"
                        }}</label>
                      </ng-template>
                    </div>
                    <!-- Bolsas de agua -->
                    <div class="form-row">
                      <label>Bolsas de agua</label>
                      <ng-container
                        *ngIf="isEditingFormE; else viewModeBolsasAgua"
                      >
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="bolsasAgua"
                            value="SI"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="bolsasAgua"
                            value="NO"
                          />
                        </label>
                        <input
                          formControlName="bolsasAguaNCertificado"
                          type="text"
                        />
                      </ng-container>
                      <ng-template #viewModeBolsasAgua>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.bolsasAgua === "SI" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.bolsasAgua === "NO" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">{{
                          formEData?.bolsasAguaNCertificado !== "N/A"
                            ? formEData?.bolsasAguaNCertificado
                            : "N/A"
                        }}</label>
                      </ng-template>
                    </div>
                    <!-- Masas -->
                    <div class="form-row">
                      <label>Masas</label>
                      <ng-container *ngIf="isEditingFormE; else viewModeMasas">
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="masas"
                            value="SI"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="masas"
                            value="NO"
                          />
                        </label>
                        <input
                          formControlName="masasNCertificado"
                          type="text"
                        />
                      </ng-container>
                      <ng-template #viewModeMasas>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.masas === "SI" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.masas === "NO" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">{{
                          formEData?.masasNCertificado !== "N/A"
                            ? formEData?.masasNCertificado
                            : "N/A"
                        }}</label>
                      </ng-template>
                    </div>
                    <!-- Dinamómetro -->
                    <div class="form-row">
                      <label>Dinamómetro</label>
                      <ng-container
                        *ngIf="isEditingFormE; else viewModeDinamometro"
                      >
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="dinamometro"
                            value="SI"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="dinamometro"
                            value="NO"
                          />
                        </label>
                        <input
                          formControlName="dinamometroNCertificado"
                          type="text"
                        />
                      </ng-container>
                      <ng-template #viewModeDinamometro>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.dinamometro === "SI" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.dinamometro === "NO" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">{{
                          formEData?.dinamometroNCertificado !== "N/A"
                            ? formEData?.dinamometroNCertificado
                            : "N/A"
                        }}</label>
                      </ng-template>
                    </div>
                    <!-- Nivel topográfico -->
                    <div class="form-row">
                      <label>Nivel topográfico</label>
                      <ng-container
                        *ngIf="isEditingFormE; else viewModeNivelTopografico"
                      >
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="nivelTopografico"
                            value="SI"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="nivelTopografico"
                            value="NO"
                          />
                        </label>
                        <input
                          formControlName="nivelTopograficoNCertificado"
                          type="text"
                        />
                      </ng-container>
                      <ng-template #viewModeNivelTopografico>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.nivelTopografico === "SI" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.nivelTopografico === "NO" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">{{
                          formEData?.nivelTopograficoNCertificado !== "N/A"
                            ? formEData?.nivelTopograficoNCertificado
                            : "N/A"
                        }}</label>
                      </ng-template>
                    </div>
                    <!-- Otro (indicar) -->
                    <div class="form-row">
                      <ng-container *ngIf="isEditingFormE; else viewModeOtro">
                        <!-- Campo editable en modo edición -->
                        <label class="center">
                          <input
                            class="width-fill-available"
                            type="text"
                            formControlName="descripcionOtro"
                            placeholder="Indicar nombre del equipo"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="otro"
                            value="SI"
                          />
                        </label>
                        <label class="center">
                          <input
                            type="radio"
                            formControlName="otro"
                            value="NO"
                          />
                        </label>
                        <input
                          formControlName="otroNCertificado"
                          type="text"
                          placeholder="Certificado Número"
                        />
                      </ng-container>
                      <ng-template #viewModeOtro>
                        <!-- Vista en modo solo lectura -->
                        <label>{{
                          formEData?.descripcionOtro !== "N/A"
                            ? formEData?.descripcionOtro
                            : "Otro (indicar)"
                        }}</label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.otro === "SI" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">
                          <span class="cuadrado2">{{
                            formEData?.otro === "NO" ? "✖" : ""
                          }}</span>
                        </label>
                        <label class="center">{{
                          formEData?.otroNCertificado !== "N/A"
                            ? formEData?.otroNCertificado
                            : "N/A"
                        }}</label>
                      </ng-template>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-row-nominal primary-row-color">
                <label class="paddingLeft"
                  ><strong>Capacidad nominal (SWL)</strong></label
                >
                <label><strong>Gancho principal</strong></label>
                <ng-container
                  *ngIf="isEditingFormE; else viewModeGanchoPrincipal"
                >
                  <input formControlName="ganchoPrincipal" type="text" />
                </ng-container>
                <ng-template #viewModeGanchoPrincipal>
                  <label>{{
                    formEData?.ganchoPrincipal !== 0
                      ? formEData?.ganchoPrincipal
                      : "N/A"
                  }}</label>
                </ng-template>
                <label>kg</label>

                <label><strong>Gancho aux.</strong></label>
                <ng-container *ngIf="isEditingFormE; else viewModeGanchoAux">
                  <input formControlName="ganchoAuxiliar" type="text" />
                </ng-container>
                <ng-template #viewModeGanchoAux>
                  <label>{{
                    formEData?.ganchoAuxiliar !== 0
                      ? formEData?.ganchoAuxiliar
                      : "N/A"
                  }}</label>
                </ng-template>
                <label>kg</label>
              </div>

              <!-- Campo para Operador (NOMBRE/RUT) -->
              <div class="form-row-single">
                <label class="paddingLeft"
                  ><strong>Operador calificado (NOMBRE/RUT)</strong></label
                >
                <!-- Modo de edición -->
                <ng-container
                  *ngIf="isEditingFormE; else viewModeNombreOperador"
                >
                  <input formControlName="nombreOperador" type="text" />
                </ng-container>
                <!-- Modo de visualización -->
                <ng-template #viewModeNombreOperador>
                  <label>{{ formE.get("nombreOperador")?.value }}</label>
                </ng-template>
              </div>
              <!-- Campo para Inspector ALS (NOMBRE/RUT) -->
              <div class="form-row-single">
                <label class="paddingLeft">
                  <strong
                    >Inspector calificado (NOMBRE/RUT)
                    <span class="required">*</span></strong
                  >
                </label>
                <!-- Modo de edición -->
                <ng-container *ngIf="isEditingFormE; else viewModeInspector">
                  <div class="input-group">
                    <input
                      formControlName="nombreRutInspector"
                      placeholder="Nombre y RUT del Inspector"
                      class="form-control"
                      [ngClass]="{
                        'is-invalid':
                          formE.get('nombreRutInspector')?.invalid &&
                          formE.get('nombreRutInspector')?.touched
                      }"
                    />
                    <!-- Mensaje de advertencia si no se ha llenado -->
                    <div
                      *ngIf="
                        formE.get('nombreRutInspector')?.invalid &&
                        formE.get('nombreRutInspector')?.touched
                      "
                      class="invalid-feedback"
                    >
                      Este campo es obligatorio.
                    </div>
                  </div>
                </ng-container>
                <!-- Modo de visualización -->
                <ng-template #viewModeInspector>
                  <label
                    *ngIf="
                      formE.get('nombreRutInspector')?.value;
                      else emptyInspector
                    "
                  >
                    {{ formE.get("nombreRutInspector")?.value }}
                  </label>
                  <!-- Mensaje si está vacío -->
                  <ng-template #emptyInspector>
                    <label class="warning">Pendiente de completar</label>
                  </ng-template>
                </ng-template>
              </div>
              <br /><br />

              <div *ngIf="!isPreviewMode" class="edit-save-buttons">
                <!-- Botón para mostrar/ocultar Gancho Principal si es mayor a 0 -->
                <ng-container *ngIf="formEData?.ganchoPrincipal > 0">
                  <button (click)="toggleGanchoPrincipal()">
                    {{
                      showGanchoPrincipal
                        ? "Ocultar Gancho Principal"
                        : "Mostrar Gancho Principal"
                    }}
                  </button>
                </ng-container>
                <!-- Botón para mostrar/ocultar Gancho Auxiliar si es mayor a 0 -->
                <ng-container *ngIf="formEData?.ganchoAuxiliar > 0">
                  <button (click)="toggleGanchoAuxiliar()">
                    {{
                      showGanchoAuxiliar
                        ? "Ocultar Gancho Auxiliar"
                        : "Mostrar Gancho Auxiliar"
                    }}
                  </button>
                </ng-container>
              </div>

              <div class="union-E">
                <label class="center title-item"><strong>Ítem</strong></label>
                <label class="center subtitle-item"
                  ><strong>Radio</strong></label
                >
                <label class="center subtitle-item"
                  ><strong>Ángulo</strong></label
                >
                <label class="center subtitle-item"
                  ><strong>Carga de prueba aplicada</strong></label
                >
                <label class="center subtitle-item"
                  ><strong>% de la capacidad nominal</strong></label
                >
              </div>
              <div class="union-gancho1">
                <label class="center title-item"
                  ><strong>Grúa #1</strong></label
                >
                <ng-container *ngIf="isEditingFormE; else viewModeGrua">
                  <label class="center align-content-center">
                    <input
                      formControlName="radioPC"
                      type="text"
                      class="center"
                    />
                  </label>
                  <label class="center align-content-center">
                    <input
                      formControlName="anguloPC"
                      type="text"
                      class="center align-content-center"
                    />
                  </label>
                  <label class="center align-content-center">
                    <input
                      formControlName="cargaPruebaAplicada"
                      type="text"
                      class="center align-content-center"
                    />
                  </label>
                  <label>kg</label>
                  <label class="center align-content-center">
                    <input
                      formControlName="porcentajeCapacidadNominal"
                      type="text"
                      class="center align-content-center"
                    />
                  </label>
                </ng-container>
                <ng-template #viewModeGrua>
                  <label class="center align-content-center">{{
                    formEData?.radioPC
                  }}</label>
                  <label class="center align-content-center">{{
                    formEData?.anguloPC
                  }}</label>
                  <label class="center align-content-center">{{
                    formEData?.cargaPruebaAplicada
                  }}</label>
                  <label>kg</label>
                  <label class="center align-content-center">{{
                    formEData?.porcentajeCapacidadNominal
                  }}</label>
                </ng-template>
              </div>

              <!-- Sección Gancho Principal -->
              <div class="union-gancho1" *ngIf="showGanchoPrincipal">
                <label class="center title-item"
                  ><strong>Gancho Principal</strong></label
                >
                <ng-container
                  *ngIf="isEditingFormE; else viewModeGanchoPrincipalDetails"
                >
                  <label class="center">
                    <input
                      formControlName="radioPCPrin"
                      type="text"
                      class="center"
                    />
                  </label>
                  <label class="center">
                    <input
                      formControlName="anguloPCPrin"
                      type="text"
                      class="center"
                    />
                  </label>
                  <label class="center">
                    <input
                      formControlName="cargaPruebaAplicadaPrin"
                      type="text"
                      class="center"
                    />
                  </label>
                  <label>kg</label>
                  <label class="center">
                    <input
                      formControlName="porcentajeCapacidadNominalPrin"
                      type="text"
                      class="center"
                    />
                  </label>
                </ng-container>
                <ng-template #viewModeGanchoPrincipalDetails>
                  <label class="center">{{
                    formEData?.radioPCPrin !== 0
                      ? formEData?.radioPCPrin
                      : "N/A"
                  }}</label>
                  <label class="center">{{
                    formEData?.anguloPCPrin !== 0
                      ? formEData?.anguloPCPrin
                      : "N/A"
                  }}</label>
                  <label class="center">{{
                    formEData?.cargaPruebaAplicadaPrin !== 0
                      ? formEData?.cargaPruebaAplicadaPrin
                      : "N/A"
                  }}</label>
                  <label>kg</label>
                  <label class="center">{{
                    formEData?.porcentajeCapacidadNominalPrin !== 0
                      ? formEData?.porcentajeCapacidadNominalPrin
                      : "N/A"
                  }}</label>
                </ng-template>
              </div>

              <!-- Sección Gancho Auxiliar -->
              <div class="union-gancho1" *ngIf="showGanchoAuxiliar">
                <label class="center title-item"
                  ><strong>Gancho Auxiliar</strong></label
                >
                <ng-container
                  *ngIf="isEditingFormE; else viewModeGanchoAuxiliar"
                >
                  <label class="center">
                    <input
                      formControlName="radioPCAux"
                      type="text"
                      class="center"
                    />
                  </label>
                  <label class="center">
                    <input
                      formControlName="anguloPCAux"
                      type="text"
                      class="center"
                    />
                  </label>
                  <label class="center">
                    <input
                      formControlName="cargaPruebaAplicadaAux"
                      type="text"
                      class="center"
                    />
                  </label>
                  <label>kg</label>
                  <label class="center">
                    <input
                      formControlName="porcentajeCapacidadNominalAux"
                      type="text"
                      class="center"
                    />
                  </label>
                </ng-container>
                <ng-template #viewModeGanchoAuxiliar>
                  <label class="center">{{
                    formEData?.radioPCAux !== 0 ? formEData?.radioPCAux : "N/A"
                  }}</label>
                  <label class="center">{{
                    formEData?.anguloPCAux !== 0
                      ? formEData?.anguloPCAux
                      : "N/A"
                  }}</label>
                  <label class="center">{{
                    formEData?.cargaPruebaAplicadaAux !== 0
                      ? formEData?.cargaPruebaAplicadaAux
                      : "N/A"
                  }}</label>
                  <label>kg</label>
                  <label class="center">{{
                    formEData?.porcentajeCapacidadNominalAux !== 0
                      ? formEData?.porcentajeCapacidadNominalAux
                      : "N/A"
                  }}</label>
                </ng-template>
              </div>
            </form>
            <div class="border-none font-weight-100">
              <h3>
                Cada dispositivo de levante (grúas) debe ser probado con una
                carga de prueba (durante 5 minutos) que exceda la carga segura
                de trabajo (SWL), como sigue:
              </h3>
            </div>

            <table class="custom-table">
              <thead>
                <tr>
                  <th>SWL</th>
                  <th>Carga de Prueba</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Hasta 20 ton</td>
                  <td>25 por ciento en exceso</td>
                </tr>
                <tr>
                  <td>20 a 50 ton</td>
                  <td>5 ton en exceso</td>
                </tr>
                <tr>
                  <td>Sobre 50 ton</td>
                  <td>10 por ciento en exceso</td>
                </tr>
              </tbody>
            </table>
            <div class="border-none font-weight-100">
              <h3>
                La prueba de carga se realizará en el ángulo o radio de trabajo
                más desfavorable sobre la horizontal. La prueba de carga debe
                incluir todos los movimientos, radio y arco en las cuales tiene
                capacidad de movimiento. CAPACIDAD CARGA MAXIMA AUTORIZADA
                <span class="font-bold underline"> SWL 12 Tons, </span> SEGÚN
                PRUEBA DE CARGA Y REQUERIMIENTOS DE CLIENTE.
              </h3>
            </div>
          </form>
        </div>
      </div>

      <div class="page">
        <div class="content">
          <form class="E1">
            <div class="custom-table-container">
              <p>
                La prueba de carga se realizará al menos una vez cada 4 años y
                en base a la siguiente matriz:
              </p>

              <table class="custom-table">
                <thead>
                  <tr>
                    <th rowspan="2" class="highlight-antiguedad">ANTIGÜEDAD</th>
                    <th rowspan="2" class="validity highlight-antiguedad">
                      VALIDEZ
                    </th>
                    <th rowspan="2" class="highlight-cargas">
                      CARGAS HABITUALES LEVANTADAS
                    </th>
                    <th rowspan="2" class="validity highlight-cargas">
                      VALIDEZ
                    </th>
                    <th rowspan="2" class="highlight-ambiente">
                      AMBIENTE DE TRABAJO
                    </th>
                    <th rowspan="2" class="validity highlight-ambiente">
                      VALIDEZ
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="highlight-antiguedad"><= 3 años</td>
                    <td class="validity highlight-antiguedad">4</td>
                    <td class="highlight-cargas"><= 40% DE SU CAPACIDAD</td>
                    <td class="validity highlight-cargas">4</td>
                    <td class="highlight-ambiente">Protegido</td>
                    <td class="validity highlight-ambiente">4</td>
                  </tr>
                  <tr>
                    <td class="highlight-antiguedad">> 3 años <= 6 años</td>
                    <td class="validity highlight-antiguedad">3</td>
                    <td class="highlight-cargas"><= 60% DE SU CAPACIDAD</td>
                    <td class="validity highlight-cargas">3</td>
                    <td class="highlight-ambiente">Calor o frío</td>
                    <td class="validity highlight-ambiente">3</td>
                  </tr>
                  <tr>
                    <td class="highlight-antiguedad">> 6 años <= 9 años</td>
                    <td class="validity highlight-antiguedad">2</td>
                    <td class="highlight-cargas"><= 80% DE SU CAPACIDAD</td>
                    <td class="validity highlight-cargas">2</td>
                    <td class="highlight-ambiente">Ambiente marino (salino)</td>
                    <td class="validity highlight-ambiente">2</td>
                  </tr>
                  <tr>
                    <td class="highlight-antiguedad">> 9 años</td>
                    <td class="validity highlight-antiguedad">1</td>
                    <td class="highlight-cargas">
                      81% <= 100% DE SU CAPACIDAD
                    </td>
                    <td class="validity highlight-cargas">1</td>
                    <td class="highlight-ambiente">
                      Humedad y vapores corrosivos
                    </td>
                    <td class="validity highlight-ambiente">1</td>
                  </tr>
                </tbody>
              </table>

              <p>
                El inspector conforme a su criterio podría indicar una validez
                menor de la carga de prueba.
              </p>
            </div>

            <h2 class="subtitle" *ngIf="tituloForm.length > 0">
              <strong>{{ tituloForm[5].nombre }}</strong>
            </h2>
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <button type="button" (click)="toggleEditFormE1()">
                {{ isEditingFormE1 ? "Cancelar" : "Editar" }}
              </button>
              <button
                type="button"
                *ngIf="isEditingFormE1"
                (click)="saveFormE1Changes()"
              >
                Guardar
              </button>
              <button (click)="toggleGanchoAuxiliarE1()">
                {{
                  showGanchoAuxiliarE1
                    ? "Ocultar Gancho Simple Auxiliar"
                    : "Mostrar Gancho Simple Auxiliar"
                }}
              </button>
              <button (click)="toggleGanchoTres()">
                {{
                  showGanchoTres
                    ? "Ocultar Gancho Simple Tres"
                    : "Mostrar Gancho Simple Tres"
                }}
              </button>
            </div>

            <form class="padding-none" [formGroup]="formE1">
              <div class="unionH2">
                <div class="title-part4">
                  <div class="title-part3">
                    <label class="paddingLeft"
                      ><strong>GANCHO DOBLE</strong></label
                    >
                    <label class="center justifyCenter"
                      ><strong>Antes de la prueba</strong></label
                    >
                    <label class="center justifyCenter"
                      ><strong>Después de la prueba</strong></label
                    >
                  </div>
                  <div class="form-row datos-h2">
                    <label class="paddingLeft"
                      ><strong>Longitud A-B</strong></label
                    >
                    <ng-container *ngIf="isEditingFormE1; else viewModeAB">
                      <input
                        type="number"
                        formControlName="longitudUABAntes"
                        min="0"
                      />
                      <label class="center">cm</label>
                      <input
                        type="number"
                        formControlName="longitudUABDesp"
                        min="0"
                      />
                      <label class="center">cm</label>
                    </ng-container>
                    <ng-template #viewModeAB>
                      <label class="center">{{
                        formE1.get("longitudUABAntes")?.value !== 0
                          ? formE1.get("longitudUABAntes")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                      <label class="center">{{
                        formE1.get("longitudUABDesp")?.value !== 0
                          ? formE1.get("longitudUABDesp")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                    </ng-template>
                  </div>
                  <div class="form-row datos-h2">
                    <label class="paddingLeft"
                      ><strong>Longitud B-C</strong></label
                    >
                    <ng-container *ngIf="isEditingFormE1; else viewModeBC">
                      <input
                        type="number"
                        formControlName="longitudDBCAntes"
                        min="0"
                      />
                      <label class="center">cm</label>
                      <input
                        type="number"
                        formControlName="longitudDBCDesp"
                        min="0"
                      />
                      <label class="center">cm</label>
                    </ng-container>
                    <ng-template #viewModeBC>
                      <label class="center">{{
                        formE1.get("longitudDBCAntes")?.value !== 0
                          ? formE1.get("longitudDBCAntes")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                      <label class="center">{{
                        formE1.get("longitudDBCDesp")?.value !== 0
                          ? formE1.get("longitudDBCDesp")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                    </ng-template>
                  </div>
                  <div class="form-row datos-h2">
                    <label class="paddingLeft"
                      ><strong>Longitud A-B'</strong></label
                    >
                    <ng-container *ngIf="isEditingFormE1; else viewModeABp">
                      <input
                        type="number"
                        formControlName="longitudTABAntes"
                        min="0"
                      />
                      <label class="center">cm</label>
                      <input
                        type="number"
                        formControlName="longitudTABDesp"
                        min="0"
                      />
                      <label class="center">cm</label>
                    </ng-container>
                    <ng-template #viewModeABp>
                      <label class="center">{{
                        formE1.get("longitudTABAntes")?.value !== 0
                          ? formE1.get("longitudTABAntes")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                      <label class="center">{{
                        formE1.get("longitudTABDesp")?.value !== 0
                          ? formE1.get("longitudTABDesp")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                    </ng-template>
                  </div>
                  <div class="form-row datos-h2">
                    <label class="paddingLeft"
                      ><strong>Longitud B-C'</strong></label
                    >
                    <ng-container *ngIf="isEditingFormE1; else viewModeBCp">
                      <input
                        type="number"
                        formControlName="longitudCBCAntes"
                        min="0"
                      />
                      <label class="center">cm</label>
                      <input
                        type="number"
                        formControlName="longitudCBCDesp"
                        min="0"
                      />
                      <label class="center">cm</label>
                    </ng-container>
                    <ng-template #viewModeBCp>
                      <label class="center">{{
                        formE1.get("longitudCBCAntes")?.value !== 0
                          ? formE1.get("longitudCBCAntes")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                      <label class="center">{{
                        formE1.get("longitudCBCDesp")?.value !== 0
                          ? formE1.get("longitudCBCDesp")?.value
                          : "N/A"
                      }}</label>
                      <label class="center">cm</label>
                    </ng-template>
                  </div>
                </div>
                <label>
                  <div class="imgH2">
                    <img
                      src="assets/formulario_puente/tipo_doble.jpg"
                      alt="Tipo doble"
                    />
                  </div>
                </label>
              </div>

              <div
                class="form-row"
                [ngClass]="{
                  resultadoH2: !isEditingFormE1,
                  flex: isEditingFormE1
                }"
              >
                <label class="text-right"><strong>Resultado (X)</strong></label>
                <ng-container *ngIf="isEditingFormE1; else viewModeResultDoble">
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      formControlName="longitudResulDoble"
                      [checked]="
                        formE1.get('longitudResulDoble')?.value ===
                        'satisfactorio'
                      "
                      value="satisfactorio"
                    />
                    Satisfactorio
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      formControlName="longitudResulDoble"
                      [checked]="
                        formE1.get('longitudResulDoble')?.value ===
                        'insatisfactorio'
                      "
                      value="insatisfactorio"
                    />
                    Insatisfactorio
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      formControlName="longitudResulDoble"
                      value=""
                    />
                    Ninguno
                  </label>
                </ng-container>
                <ng-template #viewModeResultDoble>
                  <label class="text-right">Satisfactorio</label>
                  <label class="center">
                    <span class="cuadradoH2">
                      <span
                        *ngIf="
                          formE1.get('longitudResulDoble')?.value ===
                          'satisfactorio'
                        "
                        >✖</span
                      >
                    </span>
                  </label>
                  <label class="text-right">Insatisfactorio</label>
                  <label class="center">
                    <span class="cuadradoH2">
                      <span
                        *ngIf="
                          formE1.get('longitudResulDoble')?.value ===
                          'insatisfactorio'
                        "
                        >✖</span
                      >
                    </span>
                  </label>
                  <label class="center">Tipo doble</label>
                </ng-template>
              </div>
              <br /><br />
              <div class="unionH2">
                <div class="title-part4">
                  <div class="title-part3">
                    <label class="paddingLeft"
                      ><strong>GANCHO SIMPLE PRINCIPAL</strong></label
                    >
                    <label class="center justifyCenter"
                      ><strong>Antes de la prueba</strong></label
                    >
                    <label class="center justifyCenter"
                      ><strong>Después de la prueba</strong></label
                    >
                  </div>
                  <div class="form-row datos-h2">
                    <label class="paddingLeft"
                      ><strong>Longitud A-B</strong></label
                    >
                    <ng-container
                      *ngIf="isEditingFormE1; else viewModeSimpleAB"
                    >
                      <input
                        type="number"
                        formControlName="longDABAntes"
                        min="0"
                      />
                      <label class="center">cm</label>
                      <input
                        type="number"
                        formControlName="longDABDesp"
                        min="0"
                      />
                      <label class="center">cm</label>
                    </ng-container>
                    <ng-template #viewModeSimpleAB>
                      <label class="center">{{
                        formE1.get("longDABAntes")?.value
                      }}</label>
                      <label class="center">cm</label>
                      <label class="center">{{
                        formE1.get("longDABDesp")?.value
                      }}</label>
                      <label class="center">cm</label>
                    </ng-template>
                  </div>
                  <div class="form-row datos-h2">
                    <label class="paddingLeft"
                      ><strong>Longitud B-C</strong></label
                    >
                    <ng-container
                      *ngIf="isEditingFormE1; else viewModeSimpleBC"
                    >
                      <input
                        type="number"
                        formControlName="longDBCAntes"
                        min="0"
                      />
                      <label class="center">cm</label>
                      <input
                        type="number"
                        formControlName="longDBCDesp"
                        min="0"
                      />
                      <label class="center">cm</label>
                    </ng-container>
                    <ng-template #viewModeSimpleBC>
                      <label class="center">{{
                        formE1.get("longDBCAntes")?.value
                      }}</label>
                      <label class="center">cm</label>
                      <label class="center">{{
                        formE1.get("longDBCDesp")?.value
                      }}</label>
                      <label class="center">cm</label>
                    </ng-template>
                  </div>
                </div>
                <label>
                  <div class="imgH2">
                    <img
                      src="assets/formulario_puente/tipo_simple.jpg"
                      alt="Tipo simple"
                    />
                  </div>
                </label>
              </div>
              <!-- Resultado para Gancho Simple -->
              <div
                class="form-row"
                [ngClass]="{
                  resultadoH2: !isEditingFormE1,
                  flex: isEditingFormE1
                }"
              >
                <label class="text-right"><strong>Resultado (X)</strong></label>
                <ng-container
                  *ngIf="isEditingFormE1; else viewModeResultSimple"
                >
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      formControlName="longResulSimple"
                      [checked]="
                        formE1.get('longResulSimple')?.value === 'satisfactorio'
                      "
                      value="satisfactorio"
                    />
                    Satisfactorio
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      formControlName="longResulSimple"
                      [checked]="
                        formE1.get('longResulSimple')?.value ===
                        'insatisfactorio'
                      "
                      value="insatisfactorio"
                    />
                    Insatisfactorio
                  </label>
                  <label class="cursor-pointer">
                    <input
                      type="radio"
                      formControlName="longResulSimple"
                      value=""
                    />
                    Ninguno
                  </label>
                </ng-container>
                <ng-template #viewModeResultSimple>
                  <label class="text-right">Satisfactorio</label>
                  <label class="center">
                    <span class="cuadradoH2">
                      <span
                        *ngIf="
                          formE1.get('longResulSimple')?.value ===
                          'satisfactorio'
                        "
                        >✖</span
                      >
                    </span>
                  </label>
                  <label class="text-right">Insatisfactorio</label>
                  <label class="center">
                    <span class="cuadradoH2">
                      <span
                        *ngIf="
                          formE1.get('longResulSimple')?.value ===
                          'insatisfactorio'
                        "
                        >✖</span
                      >
                    </span>
                  </label>
                  <label class="center">Tipo simple</label>
                </ng-template>
              </div>
              <br /><br />
              <div *ngIf="showGanchoAuxiliarE1">
                <div class="unionH2">
                  <div class="title-part4">
                    <div class="title-part3">
                      <label class="paddingLeft"
                        ><strong
                          >GANCHO SIMPLE AUXILIAR o GANCHO 2</strong
                        ></label
                      >
                      <label class="center justifyCenter"
                        ><strong>Antes de la prueba</strong></label
                      >
                      <label class="center justifyCenter"
                        ><strong>Después de la prueba</strong></label
                      >
                    </div>
                    <!-- Longitud A-B -->
                    <div class="form-row datos-h2">
                      <label class="paddingLeft"
                        ><strong>Longitud A-B</strong></label
                      >
                      <ng-container *ngIf="isEditingFormE1; else viewModeGSAB">
                        <input
                          type="number"
                          formControlName="longGSABAntes"
                          min="0"
                        />
                        <label class="center">cm</label>
                        <input
                          type="number"
                          formControlName="longGSABDesp"
                          min="0"
                        />
                        <label class="center">cm</label>
                      </ng-container>
                      <ng-template #viewModeGSAB>
                        <label class="center">{{
                          formE1Data?.longGSABAntes === 0
                            ? "N/A"
                            : formE1Data?.longGSABAntes
                        }}</label>
                        <label class="center">cm</label>
                        <label class="center">{{
                          formE1Data?.longGSABDesp === 0
                            ? "N/A"
                            : formE1Data?.longGSABDesp
                        }}</label>
                        <label class="center">cm</label>
                      </ng-template>
                    </div>
                    <!-- Longitud B-C -->
                    <div class="form-row datos-h2">
                      <label class="paddingLeft"
                        ><strong>Longitud B-C</strong></label
                      >
                      <ng-container *ngIf="isEditingFormE1; else viewModeGSBC">
                        <input
                          type="number"
                          formControlName="longGSBCAntes"
                          min="0"
                        />
                        <label class="center">cm</label>
                        <input
                          type="number"
                          formControlName="longGSBCDesp"
                          min="0"
                        />
                        <label class="center">cm</label>
                      </ng-container>
                      <ng-template #viewModeGSBC>
                        <label class="center">{{
                          formE1Data?.longGSBCAntes === 0
                            ? "N/A"
                            : formE1Data?.longGSBCAntes
                        }}</label>
                        <label class="center">cm</label>
                        <label class="center">{{
                          formE1Data?.longGSBCDesp === 0
                            ? "N/A"
                            : formE1Data?.longGSBCDesp
                        }}</label>
                        <label class="center">cm</label>
                      </ng-template>
                    </div>
                  </div>
                  <label>
                    <div class="imgH2">
                      <img
                        src="assets/formulario_puente/tipo_simple.jpg"
                        alt="Tipo simple"
                      />
                    </div>
                  </label>
                </div>
                <!-- Resultado para Gancho Simple -->
                <div
                  class="form-row"
                  [ngClass]="{
                    resultadoH2: !isEditingFormE1,
                    flex: isEditingFormE1
                  }"
                >
                  <label class="text-right"
                    ><strong>Resultado (X)</strong></label
                  >
                  <ng-container
                    *ngIf="isEditingFormE1; else viewModeResultSimpleDos"
                  >
                    <label class="cursor-pointer">
                      <input
                        type="radio"
                        formControlName="longResulSimpleDos"
                        [checked]="
                          formE1Data?.longResulSimpleDos === 'satisfactorio'
                        "
                        value="satisfactorio"
                      />
                      Satisfactorio
                    </label>
                    <label class="cursor-pointer">
                      <input
                        type="radio"
                        formControlName="longResulSimpleDos"
                        [checked]="
                          formE1Data?.longResulSimpleDos === 'insatisfactorio'
                        "
                        value="insatisfactorio"
                      />
                      Insatisfactorio
                    </label>
                    <label class="cursor-pointer">
                      <input
                        type="radio"
                        formControlName="longResulSimpleDos"
                        value=""
                      />
                      Ninguno
                    </label>
                  </ng-container>
                  <ng-template #viewModeResultSimpleDos>
                    <label class="text-right">Satisfactorio</label>
                    <label class="center">
                      <span class="cuadradoH2">
                        <span
                          *ngIf="
                            formE1Data?.longResulSimpleDos === 'satisfactorio'
                          "
                          >✖</span
                        >
                      </span>
                    </label>
                    <label class="text-right">Insatisfactorio</label>
                    <label class="center">
                      <span class="cuadradoH2">
                        <span
                          *ngIf="
                            formE1Data?.longResulSimpleDos === 'insatisfactorio'
                          "
                          >✖</span
                        >
                      </span>
                    </label>
                    <label class="center">Tipo simple</label>
                  </ng-template>
                </div>
              </div>
              <br /><br />
              <div *ngIf="showGanchoTres">
                <div class="unionH2">
                  <div class="title-part4">
                    <div class="title-part3">
                      <label class="paddingLeft"
                        ><strong>GANCHO SIMPLE TRES</strong></label
                      >
                      <label class="center justifyCenter"
                        ><strong>Antes de la prueba</strong></label
                      >
                      <label class="center justifyCenter"
                        ><strong>Después de la prueba</strong></label
                      >
                    </div>
                    <!-- Longitud A-B -->
                    <div class="form-row datos-h2">
                      <label class="paddingLeft"
                        ><strong>Longitud A-B</strong></label
                      >
                      <ng-container *ngIf="isEditingFormE1; else viewModeGSATB">
                        <input
                          type="number"
                          formControlName="longGSATBAntes"
                          min="0"
                        />
                        <label class="center">cm</label>
                        <input
                          type="number"
                          formControlName="longGSATBDesp"
                          min="0"
                        />
                        <label class="center">cm</label>
                      </ng-container>
                      <ng-template #viewModeGSATB>
                        <label class="center">{{
                          formE1Data?.longGSATBAntes === 0
                            ? "N/A"
                            : formE1Data?.longGSATBAntes
                        }}</label>
                        <label class="center">cm</label>
                        <label class="center">{{
                          formE1Data?.longGSATBDesp === 0
                            ? "N/A"
                            : formE1Data?.longGSATBDesp
                        }}</label>
                        <label class="center">cm</label>
                      </ng-template>
                    </div>
                    <!-- Longitud B-C -->
                    <div class="form-row datos-h2">
                      <label class="paddingLeft"
                        ><strong>Longitud B-C</strong></label
                      >
                      <ng-container *ngIf="isEditingFormE1; else viewModeGSBTC">
                        <input
                          type="number"
                          formControlName="longGSBTCAntes"
                          min="0"
                        />
                        <label class="center">cm</label>
                        <input
                          type="number"
                          formControlName="longGSBTCDesp"
                          min="0"
                        />
                        <label class="center">cm</label>
                      </ng-container>
                      <ng-template #viewModeGSBTC>
                        <label class="center">{{
                          formE1Data?.longGSBTCAntes === 0
                            ? "N/A"
                            : formE1Data?.longGSBTCAntes
                        }}</label>
                        <label class="center">cm</label>
                        <label class="center">{{
                          formE1Data?.longGSBTCDesp === 0
                            ? "N/A"
                            : formE1Data?.longGSBTCDesp
                        }}</label>
                        <label class="center">cm</label>
                      </ng-template>
                    </div>
                  </div>
                  <label>
                    <div class="imgH2">
                      <img
                        src="assets/formulario_puente/tipo_simple.jpg"
                        alt="Tipo simple tres"
                      />
                    </div>
                  </label>
                </div>
                <!-- Resultado para Gancho Simple Tres -->
                <div
                  class="form-row"
                  [ngClass]="{
                    resultadoH2: !isEditingFormE1,
                    flex: isEditingFormE1
                  }"
                >
                  <label class="text-right"
                    ><strong>Resultado (X)</strong></label
                  >
                  <ng-container
                    *ngIf="isEditingFormE1; else viewModeResultSimpleTres"
                  >
                    <label class="cursor-pointer">
                      <input
                        type="radio"
                        formControlName="longResulSimpleTres"
                        [checked]="
                          formE1Data?.longResulSimpleTres === 'satisfactorio'
                        "
                        value="satisfactorio"
                      />
                      Satisfactorio
                    </label>
                    <label class="cursor-pointer">
                      <input
                        type="radio"
                        formControlName="longResulSimpleTres"
                        [checked]="
                          formE1Data?.longResulSimpleTres === 'insatisfactorio'
                        "
                        value="insatisfactorio"
                      />
                      Insatisfactorio
                    </label>
                    <label class="cursor-pointer">
                      <input
                        type="radio"
                        formControlName="longResulSimpleTres"
                        value=""
                      />
                      Ninguno
                    </label>
                  </ng-container>
                  <ng-template #viewModeResultSimpleTres>
                    <label class="text-right">Satisfactorio</label>
                    <label class="center">
                      <span class="cuadradoH2">
                        <span
                          *ngIf="
                            formE1Data?.longResulSimpleTres === 'satisfactorio'
                          "
                          >✖</span
                        >
                      </span>
                    </label>
                    <label class="text-right">Insatisfactorio</label>
                    <label class="center">
                      <span class="cuadradoH2">
                        <span
                          *ngIf="
                            formE1Data?.longResulSimpleTres ===
                            'insatisfactorio'
                          "
                          >✖</span
                        >
                      </span>
                    </label>
                    <label class="center">Tipo simple</label>
                  </ng-template>
                </div>
              </div>
              <br /><br />
            </form>
          </form>
        </div>
      </div>

      <div class="page">
        <div class="content">
          <form class="F">
            <h2 class="subtitle" *ngIf="tituloForm.length > 0">
              {{ tituloForm[6].nombre }}
            </h2>
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <button type="button" (click)="toggleEditFormF()">
                {{ isEditingFormF ? "Cancelar" : "Editar" }}
              </button>
              <button
                type="button"
                *ngIf="isEditingFormF"
                (click)="saveFormFChanges()"
              >
                Guardar
              </button>
            </div>
            <form class="padding-none" [formGroup]="informeForm">
              <div class="form-row border-color primary-row-color">
                <label class="font-size-20"
                  ><strong
                    >De acuerdo con la inspección y prueba de carga realizadas,
                    la grúa se encuentra aprobada y en conformidad a los
                    requisitos establecidos en este informe.</strong
                  ></label
                >
              </div>
              <!-- Modo Edición -->
              <ng-container *ngIf="isEditingFormF; else viewModeResultGeneral">
                <div class="flexResul">
                  <label class="center cursor-pointer display-content">
                    <div class="font-weight-100">
                      <h3><span class="underline">Sin</span> salvedades</h3>
                    </div>
                    <input type="radio" formControlName="idResul" [value]="1" />
                  </label>
                </div>
                <div class="flexResul">
                  <label class="center cursor-pointer display-content">
                    <div class="font-weight-100">
                      <h3><span class="underline">Con</span> salvedades</h3>
                    </div>
                    <input type="radio" formControlName="idResul" [value]="2" />
                  </label>
                </div>
                <span>(ver sección D de este informe)</span>
              </ng-container>
              <!-- Modo Visualización -->

              <ng-template #viewModeResultGeneral>
                <div class="flexResul">
                  <div class="font-weight-100">
                    <h3><span class="underline">Sin</span> salvedades</h3>
                  </div>
                  <label class="center">
                    <span class="cuadradoH2">{{
                      selectedInforme.idResul === 1 ? "✖" : ""
                    }}</span>
                  </label>
                </div>

                <div class="flexResul">
                  <div class="font-weight-100">
                    <h3><span class="underline">Con</span> salvedades</h3>
                  </div>
                  <label class="center">
                    <span class="cuadradoH2">{{
                      selectedInforme.idResul === 2 ? "✖" : ""
                    }}</span>
                  </label>
                </div>

                <span>(ver sección D de este informe)</span>
              </ng-template>
              <br />
              <div class="font-weight-100 font-size-20">
                <h3>
                  Para todos los efectos, este documento se considera el informe
                  de inspección.
                </h3>
                <br />
                <h3>
                  Documento asociado: Certificado de Inspección y Prueba de
                  Carga (Solo en caso de pasar satisfactoriamente inspección):
                  <strong>{{ informeForm.get("numeroInforme")?.value }}</strong>
                </h3>
                <br /><br />
                <div class="justifyCenter center">
                  <h3>
                    Este informe se realizó sin prejuicio de ningún tipo y para
                    el interés de quien<br />concierna.
                  </h3>
                </div>
                <br /><br /><br />
                <h4 class="center justifyCenter">
                  Nombre y firma <br />INSPECTOR <br />ALS Inspection Chile SPA
                </h4>
              </div>
            </form>
          </form>
        </div>
      </div>

      <br /><br /><br /><br /><br /><br />

      <div class="page">
        <div class="content">
          <form class="G">
            <h2
              class="center justifyCenter font-size-xxxlarge"
              *ngIf="tituloForm.length > 0"
            >
              <strong>{{ tituloForm[7].nombre }}</strong>
            </h2>
            <div *ngIf="!isPreviewMode" class="edit-save-buttons">
              <div class="edit-save-buttons">
                <button type="button" (click)="toggleEditImages()">
                  {{ isEditingImages ? "Cancelar" : "Editar" }}
                </button>
                <button
                  type="button"
                  *ngIf="isEditingImages"
                  (click)="saveImageChanges()"
                >
                  Guardar
                </button>
              </div>
              <button (click)="openSetFotograficoModal()">
                Agregar Imágenes
              </button>
            </div>
            <div class="photo-grid">
              <div [formGroup]="photoDescriptionsForm" class="display-content">
                <div
                  *ngFor="let photo of photos; let i = index"
                  class="photo-item"
                >
                  <img
                    [src]="'data:image/png;base64,' + photo.data"
                    [alt]="photo.descripcionSF"
                  />

                  <!-- Modo edición -->
                  <div *ngIf="isEditingImages; else viewMode">
                    <input
                      type="text"
                      [formControlName]="'descripcionSF_' + photo.numero"
                      placeholder="Editar descripción"
                    />
                    <button
                      (click)="confirmDeletePhoto(photo)"
                      class="delete-btn"
                    >
                      Eliminar
                    </button>
                  </div>

                  <!-- Vista de solo lectura -->
                  <ng-template #viewMode>
                    <span>{{ photo.descripcionSF }}</span>
                  </ng-template>
                </div>
              </div>

              <app-photographic-set-modal
                *ngIf="showSetFotograficoModal"
                [idInforme]="modalInstance?.idInforme"
                [numeroInforme]="modalInstance?.numeroInforme"
                [allowImages]="modalInstance?.allowImages"
                [maxPhotoNumber]="modalInstance?.maxPhotoNumber"
                [uploadImageService]="modalInstance?.uploadImageService"
                [disableCancel]="photos.length === 6"
                (save)="onSaveSetFotografico($event)"
                (cancel)="onCancelSetFotografico()"
              >
              </app-photographic-set-modal>
            </div>
          </form>
        </div>
      </div>

      <div class="page">
        <div class="content">
          <form class="H">
            <h2 class="center justifyCenter font-size-xxxlarge">
        <strong>Set fotográfico No Conformidades</strong>
      </h2>
     <!-- <div *ngIf="!isPreviewMode" class="edit-save-buttons">
        <button type="button" (click)="toggleEditNcImages()"> {{ isEditingNcImages ? "Cancelar" : "Editar" }} </button>
        <button type="button" *ngIf="isEditingNcImages" (click)="saveNcImageChanges()"> Guardar </button>
        <button (click)="openNoConformidadesModal()"> Agregar Imágenes </button>
      </div> -->
      <div class="photo-grid">
        <div [formGroup]="ncPhotoDescriptionsForm" class="display-content">
          <div *ngFor="let photo of ncPhotos; let i = index" class="photo-item">
            <img [src]="'data:image/png;base64,' + photo.data" [alt]="photo.descripFoto" />
            <p>Ítem: {{ photo.idDetalle }} </p>
            <div *ngIf="isEditingNcImages; else viewMode">
              <input type="text" [formControlName]="'descripFoto_' + photo.idDetalle" placeholder="Editar descripción" />
              <!-- <button (click)="confirmDeleteNcPhoto(photo)" class="delete-btn">Eliminar</button> -->
            </div>
            <ng-template #viewMode>
              <span>{{ photo.descripFoto }}</span>
            </ng-template>
          </div>
        </div>
      </div>
          </form>
        </div>
      </div>

    </div>
  </div>
</div>
